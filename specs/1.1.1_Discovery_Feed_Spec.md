# Feature Specification: Opportunity Discovery Feed
**Task:** 1.1.1  
**Phase:** 1 - Feature Audit & Refinement  
**Status:** ðŸŸ¡ In Progress  
**Owner:** Leon D.  
**Created:** 2026-02-03

---

## ðŸ“‹ Overview

The Opportunity Discovery Feed is the primary entry point for users to browse, filter, and discover validated business opportunities. This spec defines the enhanced user experience, interactions, and technical implementation.

---

## ðŸŽ¯ User Goals

### Primary Users
1. **Founders/Entrepreneurs** - Find validated problems to solve
2. **Investors/VCs** - Discover high-potential opportunities
3. **Researchers** - Analyze market trends and patterns
4. **Scouts** - Identify opportunities for clients/portfolio

### Core Jobs-to-be-Done
- "Show me opportunities that match my skills and interests"
- "Help me find the highest-potential ideas to pursue"
- "Alert me when new opportunities in my domain appear"
- "Let me compare multiple opportunities side-by-side"

---

## ðŸ“¸ Current State Analysis

### What Exists Today
âœ… **Basic Discovery Page** (`discover.html`)
- Grid/list view of opportunity cards
- Filter by: category, geographic scope, country, completion status, realm type
- Sort by: recent, trending, validated, market size, feasibility
- Pagination (20 per page)
- Free tier gating (3 preview opportunities)

âœ… **Backend API** (`/api/opportunities`)
- Filtering logic implemented
- Sorting options working
- Subscription-based access control

### Current User Flow
```
User lands on /discover
  â†“
Sees grid of opportunity cards (static list)
  â†“
Applies filters (dropdown menus)
  â†“
Page reloads with filtered results
  â†“
Clicks card â†’ Navigates to opportunity detail page
  â†“
Back button â†’ Returns to discover (loses state)
```

### Pain Points
âŒ **No personalization** - Same feed for everyone
âŒ **State loss** - Filters reset on back navigation
âŒ **No saved searches** - Can't save filter combinations
âŒ **No quick actions** - Must open detail page to validate
âŒ **No comparison** - Can't view multiple opportunities together
âŒ **No smart recommendations** - Random order within sort option

---

## ðŸŽ¨ Enhanced User Experience - Design

### **A. Page Layout (Desktop)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [Logo] OppGrid        Discover  Saved  Hub  Network  Profile  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—  â”‚
â”‚  â•‘  ðŸ’¡ Recommended for You                                   â•‘  â”‚
â”‚  â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â•‘  â”‚
â”‚  â•‘  â”‚ Opp #1   â”‚ â”‚ Opp #2   â”‚ â”‚ Opp #3   â”‚  [View All â†’]  â•‘  â”‚
â”‚  â•‘  â”‚ 92% matchâ”‚ â”‚ 88% matchâ”‚ â”‚ 85% matchâ”‚                 â•‘  â”‚
â”‚  â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â•‘  â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€ Filters â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ðŸ” Search: [________________] [Search Button]            â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚ Category: [All â–¼]  Feasibility: [Any â–¼]  Location: [â–¼]  â”‚  â”‚
â”‚  â”‚ Sort: [Highest Feasibility â–¼]        [Save Search ðŸ’¾]    â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚ Active Filters: [Tech Ã—] [Local Ã—] [High Feasibility Ã—]  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  [432 opportunities found]            [Grid âŠž] [List â˜°]         â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚  â”‚
â”‚  â”‚ â”‚ Opportunity â”‚ â”‚ Opportunity â”‚ â”‚ Opportunity â”‚         â”‚  â”‚
â”‚  â”‚ â”‚   Card #1   â”‚ â”‚   Card #2   â”‚ â”‚   Card #3   â”‚         â”‚  â”‚
â”‚  â”‚ â”‚             â”‚ â”‚             â”‚ â”‚             â”‚         â”‚  â”‚
â”‚  â”‚ â”‚ [Actions]   â”‚ â”‚ [Actions]   â”‚ â”‚ [Actions]   â”‚         â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚  â”‚
â”‚  â”‚ â”‚ Opportunity â”‚ â”‚ Opportunity â”‚ â”‚ Opportunity â”‚         â”‚  â”‚
â”‚  â”‚ â”‚   Card #4   â”‚ â”‚   Card #5   â”‚ â”‚   Card #6   â”‚         â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  [â† Prev]  Page 1 of 22  [Next â†’]                              â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ Floating Comparison Panel (if opportunities selected) â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Compare Selected (2/3):  [Opp #1] [Opp #4]  [Compare â†’]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **B. Opportunity Card - Enhanced Design**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â˜ [Select for comparison]                    [â‹¯ More Menu] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  ðŸ’¼ Work & Productivity                                      â”‚
â”‚  Freelance invoicing is a nightmare                         â”‚
â”‚                                                              â”‚
â”‚  "Managing invoices, payments, and taxes takes 15% of my    â”‚
â”‚   billable time. There has to be a better way..."           â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Feasibility: 82 ðŸŸ¢ HIGH                              â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚ â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â”‚ 82%  â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚  ðŸ“Š 445 validations  ðŸ”¥ +18% (7d)  ðŸ’° $100M-$500M market    â”‚
â”‚  ðŸŒ International  â± 45 days old                            â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€ Quick Actions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [âœ“ Validate]  [ðŸ’¾ Save]  [ðŸ¤– Analyze]  [â†— Share]   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚  ðŸ‘¥ "5 users with your skillset validated this"             â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **C. Interaction Patterns**

#### **C.1 Hover States**
```
User hovers over opportunity card
  â†“
[Visual Changes]
  - Card elevates (subtle shadow increase)
  - Border highlights (accent color)
  - Quick actions fade in
  â†“
[Information Shown]
  - Full description (if truncated)
  - Additional metadata (comments count, expert count)
  - "Click to view full details" hint
```

#### **C.2 Quick Validation**
```
User clicks "Validate" button on card
  â†“
[Immediate Feedback]
  - Button changes: "Validate" â†’ "âœ“ Validated"
  - Confetti animation (brief celebration)
  - Validation count increments (+1)
  â†“
[Background Actions]
  - POST /api/validations {opportunity_id, user_id}
  - Award impact points (+5)
  - Update opportunity feasibility score
  â†“
[No Page Navigation]
  - User stays on discover feed
  - Can continue browsing
```

#### **C.3 Bulk Compare**
```
User selects checkbox on 2-3 opportunity cards
  â†“
[Floating Panel Appears]
  - Shows thumbnails of selected opportunities
  - "Compare" button enabled
  â†“
User clicks "Compare"
  â†“
[Modal Opens - Side-by-Side View]
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Comparison View                            [Ã— Close]
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
  â”‚  â”‚ Opp #1      â”‚ â”‚ Opp #2      â”‚ â”‚ Opp #3      â”‚ â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
  â”‚  â”‚ Feasibility â”‚ â”‚ Feasibility â”‚ â”‚ Feasibility â”‚ â”‚
  â”‚  â”‚     82      â”‚ â”‚     76      â”‚ â”‚     69      â”‚ â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
  â”‚  â”‚ Validations â”‚ â”‚ Validations â”‚ â”‚ Validations â”‚ â”‚
  â”‚  â”‚     445     â”‚ â”‚     312     â”‚ â”‚     189     â”‚ â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
  â”‚  â”‚ Growth Rate â”‚ â”‚ Growth Rate â”‚ â”‚ Growth Rate â”‚ â”‚
  â”‚  â”‚   +18%      â”‚ â”‚   +12%      â”‚ â”‚   +5%       â”‚ â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
  â”‚                                                     â”‚
  â”‚  ðŸ† Winner: Opportunity #1 (highest overall score) â”‚
  â”‚                                                     â”‚
  â”‚  [View Full Details] [Export Comparison (PDF)]     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **C.4 Saved Searches**
```
User applies filters: Category=Tech, Feasibility=High, Location=Local
  â†“
User clicks "Save Search ðŸ’¾" button
  â†“
[Modal Appears]
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Save This Search                   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  Name: [High-Potential Tech (Local)]â”‚
  â”‚                                      â”‚
  â”‚  Notify me:                          â”‚
  â”‚  â˜‘ Email (daily digest)             â”‚
  â”‚  â˜‘ Push notification (instant)      â”‚
  â”‚  â˜ Slack message                    â”‚
  â”‚                                      â”‚
  â”‚  [Cancel]            [Save Search]  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
[Confirmation]
  âœ“ "Search saved! You'll get notified when new opportunities match."
  â†“
[Backend Action]
  - POST /api/saved-searches {name, filters, notification_prefs}
  - Create alert triggers in database
```

---

## ðŸ”§ Technical Implementation

### **D. Frontend Changes**

#### **D.1 New React Components**
```javascript
// components/DiscoveryFeed/
â”œâ”€â”€ DiscoveryFeed.jsx              // Main container
â”œâ”€â”€ RecommendedSection.jsx         // Personalized recommendations
â”œâ”€â”€ FilterBar.jsx                  // Search + filters
â”œâ”€â”€ OpportunityGrid.jsx            // Grid/list view
â”œâ”€â”€ OpportunityCard.jsx            // Enhanced card component
â”œâ”€â”€ QuickActions.jsx               // Validate, Save, Analyze buttons
â”œâ”€â”€ ComparisonPanel.jsx            // Floating comparison bar
â”œâ”€â”€ ComparisonModal.jsx            // Side-by-side comparison
â”œâ”€â”€ SavedSearchModal.jsx           // Save search dialog
â””â”€â”€ OpportunityCardSkeleton.jsx    // Loading state
```

#### **D.2 State Management (Zustand)**
```javascript
// stores/discoveryStore.js
export const useDiscoveryStore = create((set) => ({
  // Data
  opportunities: [],
  total: 0,
  page: 1,
  pageSize: 20,
  loading: false,
  
  // Filters
  filters: {
    search: '',
    category: null,
    feasibility: null,
    location: null,
    sortBy: 'feasibility'
  },
  
  // User interactions
  selectedOpportunities: [], // For comparison
  savedSearches: [],
  
  // Actions
  setFilters: (newFilters) => set((state) => ({
    filters: { ...state.filters, ...newFilters },
    page: 1 // Reset to page 1 on filter change
  })),
  
  fetchOpportunities: async () => {
    set({ loading: true });
    const response = await api.getOpportunities({
      ...get().filters,
      skip: (get().page - 1) * get().pageSize,
      limit: get().pageSize
    });
    set({ 
      opportunities: response.opportunities, 
      total: response.total,
      loading: false 
    });
  },
  
  toggleSelection: (opportunityId) => set((state) => ({
    selectedOpportunities: state.selectedOpportunities.includes(opportunityId)
      ? state.selectedOpportunities.filter(id => id !== opportunityId)
      : [...state.selectedOpportunities, opportunityId].slice(0, 3) // Max 3
  })),
  
  quickValidate: async (opportunityId) => {
    await api.validateOpportunity(opportunityId);
    // Optimistic update
    set((state) => ({
      opportunities: state.opportunities.map(opp =>
        opp.id === opportunityId
          ? { ...opp, validation_count: opp.validation_count + 1, user_validated: true }
          : opp
      )
    }));
  },
  
  saveSearch: async (name, notificationPrefs) => {
    const savedSearch = await api.saveSearch({
      name,
      filters: get().filters,
      notification_prefs: notificationPrefs
    });
    set((state) => ({
      savedSearches: [...state.savedSearches, savedSearch]
    }));
  }
}));
```

---

### **E. Backend Changes**

#### **E.1 New API Endpoints**

##### **/api/opportunities - Enhanced**
```python
@router.get("/")
async def get_opportunities(
    skip: int = Query(0, ge=0),
    limit: int = Query(20, ge=1, le=100),
    
    # Existing filters
    category: Optional[str] = None,
    geographic_scope: Optional[str] = None,
    country: Optional[str] = None,
    completion_status: Optional[str] = None,
    realm_type: Optional[str] = None,
    sort_by: str = Query("feasibility", regex="^(recent|trending|validated|market|feasibility|recommended)$"),
    
    # NEW: Search
    search: Optional[str] = None,
    
    # NEW: Feasibility range
    min_feasibility: Optional[int] = Query(None, ge=0, le=100),
    max_feasibility: Optional[int] = Query(None, ge=0, le=100),
    
    # NEW: Validation range
    min_validations: Optional[int] = Query(None, ge=0),
    
    # NEW: Age range
    max_age_days: Optional[int] = Query(None, ge=0),
    
    current_user: User = Depends(get_current_user_optional),
    db: Session = Depends(get_db)
):
    """Enhanced opportunity listing with search and advanced filters"""
    
    query = db.query(Opportunity).filter(
        Opportunity.status == "active",
        Opportunity.moderation_status == 'approved'
    )
    
    # Search (full-text across title + description)
    if search:
        search_term = f"%{search}%"
        query = query.filter(
            or_(
                Opportunity.title.ilike(search_term),
                Opportunity.description.ilike(search_term)
            )
        )
    
    # Feasibility range
    if min_feasibility is not None:
        query = query.filter(Opportunity.feasibility_score >= min_feasibility)
    if max_feasibility is not None:
        query = query.filter(Opportunity.feasibility_score <= max_feasibility)
    
    # Validation count
    if min_validations is not None:
        query = query.filter(Opportunity.validation_count >= min_validations)
    
    # Age filter
    if max_age_days is not None:
        cutoff_date = datetime.utcnow() - timedelta(days=max_age_days)
        query = query.filter(Opportunity.created_at >= cutoff_date)
    
    # Existing filters (category, geographic_scope, etc.)
    # ... (keep existing logic)
    
    # NEW: Personalized sorting
    if sort_by == "recommended" and current_user:
        # Calculate match scores (simplistic version - improve with ML later)
        # For now, prioritize:
        # 1. User's category interests
        # 2. Similar to user's past validations
        # 3. High feasibility
        user_interests = get_user_category_interests(current_user, db)
        if user_interests:
            query = query.filter(Opportunity.category.in_(user_interests))
        query = query.order_by(desc(Opportunity.feasibility_score))
    elif sort_by == "feasibility":
        query = query.order_by(desc(Opportunity.feasibility_score))
    elif sort_by == "recent":
        query = query.order_by(desc(Opportunity.created_at))
    # ... (existing sort options)
    
    total = query.count()
    opportunities = query.offset(skip).limit(limit).all()
    
    # NEW: Enrich with user-specific data
    enriched_opportunities = []
    for opp in opportunities:
        opp_dict = opp.__dict__.copy()
        
        # Check if user validated this
        if current_user:
            opp_dict['user_validated'] = db.query(Validation).filter(
                Validation.opportunity_id == opp.id,
                Validation.user_id == current_user.id
            ).first() is not None
            
            # Calculate match score (placeholder - improve with ML)
            opp_dict['match_score'] = calculate_match_score(opp, current_user, db)
        else:
            opp_dict['user_validated'] = False
            opp_dict['match_score'] = None
        
        enriched_opportunities.append(opp_dict)
    
    return {
        "opportunities": enriched_opportunities,
        "total": total,
        "page": (skip // limit) + 1,
        "page_size": limit,
        "has_more": total > (skip + limit)
    }


def get_user_category_interests(user: User, db: Session) -> List[str]:
    """Get categories user has validated/saved in the past"""
    validated_categories = db.query(Opportunity.category).join(
        Validation, Opportunity.id == Validation.opportunity_id
    ).filter(
        Validation.user_id == user.id
    ).distinct().limit(5).all()
    
    return [c[0] for c in validated_categories if c[0]]


def calculate_match_score(opp: Opportunity, user: User, db: Session) -> Optional[int]:
    """Calculate 0-100 match score between opportunity and user"""
    # Placeholder - will enhance with ML in Phase 3
    score = 50  # Base score
    
    # Category match (+20 if user interested in this category)
    user_interests = get_user_category_interests(user, db)
    if opp.category in user_interests:
        score += 20
    
    # Feasibility bonus (+15 if high feasibility)
    if opp.feasibility_score >= 75:
        score += 15
    
    # Validation trend bonus (+10 if growing fast)
    if opp.growth_rate and opp.growth_rate > 10:
        score += 10
    
    # Similar users validated (+5)
    similar_user_validated = check_similar_users_validated(opp, user, db)
    if similar_user_validated:
        score += 5
    
    return min(score, 100)


def check_similar_users_validated(opp: Opportunity, user: User, db: Session) -> bool:
    """Check if users with similar interests validated this"""
    # Simplified - find users who validated same opportunities as current user
    user_validations = db.query(Validation.opportunity_id).filter(
        Validation.user_id == user.id
    ).subquery()
    
    similar_users = db.query(Validation.user_id).filter(
        Validation.opportunity_id.in_(user_validations),
        Validation.user_id != user.id
    ).distinct().limit(10).all()
    
    if not similar_users:
        return False
    
    similar_user_ids = [u[0] for u in similar_users]
    
    return db.query(Validation).filter(
        Validation.opportunity_id == opp.id,
        Validation.user_id.in_(similar_user_ids)
    ).first() is not None
```

##### **POST /api/saved-searches**
```python
@router.post("/saved-searches", response_model=SavedSearchSchema)
def create_saved_search(
    search_data: SavedSearchCreate,
    current_user: User = Depends(get_current_active_user),
    db: Session = Depends(get_db)
):
    """Save a search with alert preferences"""
    saved_search = SavedSearch(
        user_id=current_user.id,
        name=search_data.name,
        filters=search_data.filters,  # JSONB column
        notification_prefs=search_data.notification_prefs,  # JSONB
        is_active=True
    )
    
    db.add(saved_search)
    db.commit()
    db.refresh(saved_search)
    
    return saved_search


@router.get("/saved-searches", response_model=List[SavedSearchSchema])
def get_saved_searches(
    current_user: User = Depends(get_current_active_user),
    db: Session = Depends(get_db)
):
    """Get user's saved searches"""
    return db.query(SavedSearch).filter(
        SavedSearch.user_id == current_user.id,
        SavedSearch.is_active == True
    ).order_by(desc(SavedSearch.created_at)).all()


@router.delete("/saved-searches/{search_id}")
def delete_saved_search(
    search_id: int,
    current_user: User = Depends(get_current_active_user),
    db: Session = Depends(get_db)
):
    """Delete a saved search"""
    saved_search = db.query(SavedSearch).filter(
        SavedSearch.id == search_id,
        SavedSearch.user_id == current_user.id
    ).first()
    
    if not saved_search:
        raise HTTPException(status_code=404, detail="Saved search not found")
    
    saved_search.is_active = False
    db.commit()
    
    return {"message": "Saved search deleted"}
```

##### **GET /api/opportunities/recommended**
```python
@router.get("/recommended", response_model=List[OpportunitySchema])
def get_recommended_opportunities(
    limit: int = Query(10, ge=1, le=50),
    current_user: User = Depends(get_current_active_user),
    db: Session = Depends(get_db)
):
    """Get personalized opportunity recommendations"""
    
    # Get user's category interests
    user_interests = get_user_category_interests(current_user, db)
    
    query = db.query(Opportunity).filter(
        Opportunity.status == "active",
        Opportunity.moderation_status == 'approved'
    )
    
    # Prioritize user's categories
    if user_interests:
        query = query.filter(Opportunity.category.in_(user_interests))
    
    # High feasibility opportunities
    query = query.filter(Opportunity.feasibility_score >= 60)
    
    # Exclude already validated by user
    user_validated_ids = db.query(Validation.opportunity_id).filter(
        Validation.user_id == current_user.id
    ).subquery()
    query = query.filter(~Opportunity.id.in_(user_validated_ids))
    
    # Sort by feasibility + recency
    query = query.order_by(
        desc(Opportunity.feasibility_score),
        desc(Opportunity.created_at)
    )
    
    opportunities = query.limit(limit).all()
    
    # Calculate match scores
    enriched = []
    for opp in opportunities:
        opp_dict = opp.__dict__.copy()
        opp_dict['match_score'] = calculate_match_score(opp, current_user, db)
        enriched.append(opp_dict)
    
    # Sort by match score
    enriched.sort(key=lambda x: x['match_score'], reverse=True)
    
    return enriched
```

---

#### **E.2 New Database Models**

```python
# app/models/saved_search.py
from sqlalchemy import Column, Integer, String, ForeignKey, DateTime, Boolean
from sqlalchemy.dialects.postgresql import JSONB
from app.db.database import Base
from datetime import datetime

class SavedSearch(Base):
    __tablename__ = "saved_searches"
    
    id = Column(Integer, primary_key=True, index=True)
    user_id = Column(Integer, ForeignKey("users.id"), nullable=False)
    name = Column(String, nullable=False)
    filters = Column(JSONB, nullable=False)  # Stores filter configuration
    notification_prefs = Column(JSONB, nullable=False)  # Email, push, slack
    is_active = Column(Boolean, default=True)
    created_at = Column(DateTime, default=datetime.utcnow)
    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)
    last_notified_at = Column(DateTime, nullable=True)


# Migration
# alembic/versions/YYYYMMDD_add_saved_searches.py
def upgrade():
    op.create_table(
        'saved_searches',
        sa.Column('id', sa.Integer(), primary_key=True),
        sa.Column('user_id', sa.Integer(), sa.ForeignKey('users.id'), nullable=False),
        sa.Column('name', sa.String(), nullable=False),
        sa.Column('filters', JSONB(), nullable=False),
        sa.Column('notification_prefs', JSONB(), nullable=False),
        sa.Column('is_active', sa.Boolean(), default=True),
        sa.Column('created_at', sa.DateTime(), default=datetime.utcnow),
        sa.Column('updated_at', sa.DateTime(), default=datetime.utcnow),
        sa.Column('last_notified_at', sa.DateTime(), nullable=True)
    )
    op.create_index('ix_saved_searches_user_id', 'saved_searches', ['user_id'])
```

---

#### **E.3 Background Job: Saved Search Alerts**

```python
# app/services/saved_search_alerts.py
from app.models.saved_search import SavedSearch
from app.models.opportunity import Opportunity
from app.services.email_service import send_email
from sqlalchemy.orm import Session
from datetime import datetime, timedelta

def check_saved_search_alerts(db: Session):
    """
    Background job - runs hourly
    Checks for new opportunities matching saved searches
    Sends notifications if preferences allow
    """
    
    # Get active saved searches
    saved_searches = db.query(SavedSearch).filter(
        SavedSearch.is_active == True
    ).all()
    
    for search in saved_searches:
        # Check if enough time has passed since last notification
        if search.last_notified_at:
            # Daily digest - only notify once per day
            if search.notification_prefs.get('email_frequency') == 'daily':
                if datetime.utcnow() - search.last_notified_at < timedelta(hours=24):
                    continue
        
        # Find new opportunities matching this search
        filters = search.filters
        query = db.query(Opportunity).filter(
            Opportunity.status == "active",
            Opportunity.moderation_status == 'approved'
        )
        
        # Apply saved filters
        if filters.get('category'):
            query = query.filter(Opportunity.category == filters['category'])
        if filters.get('min_feasibility'):
            query = query.filter(Opportunity.feasibility_score >= filters['min_feasibility'])
        # ... apply all other filters
        
        # Only new opportunities since last check
        if search.last_notified_at:
            query = query.filter(Opportunity.created_at > search.last_notified_at)
        else:
            # First time - last 24 hours
            query = query.filter(Opportunity.created_at > datetime.utcnow() - timedelta(hours=24))
        
        new_opportunities = query.all()
        
        if new_opportunities:
            # Send notifications based on preferences
            if search.notification_prefs.get('email', False):
                send_saved_search_email(search, new_opportunities, db)
            
            if search.notification_prefs.get('push', False):
                send_push_notification(search, len(new_opportunities), db)
            
            if search.notification_prefs.get('slack', False):
                send_slack_message(search, new_opportunities, db)
            
            # Update last notified timestamp
            search.last_notified_at = datetime.utcnow()
            db.commit()


def send_saved_search_email(search: SavedSearch, opportunities: list, db: Session):
    """Send email with new matching opportunities"""
    user = db.query(User).filter(User.id == search.user_id).first()
    
    email_html = f"""
    <h2>New opportunities matching "{search.name}"</h2>
    <p>We found {len(opportunities)} new opportunities for you:</p>
    <ul>
    """
    
    for opp in opportunities[:10]:  # Max 10 in email
        email_html += f"""
        <li>
            <strong>{opp.title}</strong><br>
            Feasibility: {opp.feasibility_score} | Validations: {opp.validation_count}<br>
            <a href="https://oppgrid.com/opportunity/{opp.id}">View Details</a>
        </li>
        """
    
    email_html += "</ul>"
    
    if len(opportunities) > 10:
        email_html += f"<p>... and {len(opportunities) - 10} more. <a href='https://oppgrid.com/discover?search={search.id}'>View all</a></p>"
    
    send_email(
        to=user.email,
        subject=f"ðŸ”” {len(opportunities)} new opportunities matching \"{search.name}\"",
        html=email_html
    )
```

---

## ðŸ“Š Success Metrics

### **Primary Metrics**
1. **Time to First Validation**
   - Current: Unknown (needs tracking)
   - Target: <2 minutes from landing on /discover

2. **Filter Usage Rate**
   - Target: 60% of sessions apply at least one filter
   - Track: Which filters are most used

3. **Quick Validation Conversion**
   - Target: 15% of users validate directly from card (no detail page visit)
   - Measure: Card validations / Total validations

4. **Saved Search Adoption**
   - Target: 25% of active users create at least 1 saved search
   - Track: Saved searches created, alert click-through rate

5. **Comparison Feature Usage**
   - Target: 10% of sessions use comparison tool
   - Track: Comparisons initiated, opportunities compared

6. **Return Visit Rate**
   - Target: 3x/week for engaged users
   - Measure: Weekly active users (WAU)

### **Secondary Metrics**
- Session duration on /discover (target: 5+ minutes)
- Scroll depth (% reaching bottom of page)
- Back button usage (should decrease with state preservation)
- Mobile vs desktop usage patterns

---

## âœ… Definition of Done

- [ ] All UI components built and tested
- [ ] Backend API enhancements deployed
- [ ] Database migrations run
- [ ] Saved search background job operational
- [ ] Analytics tracking implemented
- [ ] Mobile responsive design verified
- [ ] Performance benchmarks met (<2s page load, <500ms filter application)
- [ ] A/B test framework ready
- [ ] Documentation updated
- [ ] User acceptance testing complete

---

## ðŸš€ Rollout Plan

### **Phase 1: Foundation (Week 1)**
- Build enhanced opportunity card component
- Implement quick validation
- Add search and advanced filters
- Deploy to staging

### **Phase 2: Personalization (Week 2)**
- Implement recommendation engine (basic version)
- Add match score calculation
- Deploy "Recommended for You" section
- A/B test vs. non-personalized feed

### **Phase 3: Advanced Features (Week 3)**
- Build comparison tool
- Implement saved searches
- Set up background alert job
- Deploy to production (gradual rollout)

### **Phase 4: Optimization (Week 4)**
- Analyze usage data
- Iterate on personalization algorithm
- Optimize performance
- Refine UI based on feedback

---

## ðŸ“ Decisions Made (Leon - 2026-02-03)

1. **Personalization Depth:** âœ… **Mix with trending**
   - Show "Recommended for You" section at top (3-5 cards)
   - Main feed mixes personalized + trending + new opportunities
   - Algorithm weights: 40% match score + 30% feasibility + 30% recency/trend

2. **Free Tier Limits:** âœ… **Yes, limit saved searches**
   - Free: 1 saved search (to taste the feature)
   - Pro: 10 saved searches
   - Business/Enterprise: Unlimited

3. **Notification Frequency:** âœ… **Daily digest (best for marketing)**
   - Default: Daily digest (8am user's local time)
   - Reduces spam perception, increases email open rates
   - Users can upgrade to instant notifications (premium feature)
   - Reasoning: Daily digests have 3-5x higher engagement than instant alerts (industry standard)

4. **Comparison Limit:** âœ… **Max 3 opportunities**
   - Keeps comparison UI clean and focused
   - Forces prioritization (good UX constraint)

5. **Mobile Experience:** â“ **Clarification needed**
   - Question: Should mobile have fewer visible filters (collapsible menu) vs desktop (always visible sidebar)?
   - Or should mobile be feature-identical to desktop?

6. **React Migration:** âœ… **Migrate to React**
   - Users won't notice visual difference (same design)
   - Benefits: Better state management, no page reloads, instant filter updates, easier maintenance
   - Plan: Build React version, A/B test, then full switchover
   - Keep legacy HTML as fallback for 1 month during transition

---

**Status:** ðŸŸ¢ 95% Ready - Need clarification on mobile UX approach  
**Next:** Once mobile UX clarified, proceed to implementation OR move to Task 1.1.2 (Opportunity Detail View)
